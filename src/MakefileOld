# Makefile for the socket programming example
#
IDIR =../include
CC=g++
CFLAGS=-I$(IDIR) -g -pg -Ofast -std=c++11

LIBS=-lm

_DEPS = CRIoT.h
DEPS = $(patsubst %,$(IDIR)/%,$(_DEPS))
ODIR=obj


SERVER_OBJ = ClientSocket.o ServerSocket.o Socket.o server.o
client_objects = ClientSocket.o ServerSocket.o Socket.o client.o

all : server client

client.o: client.cpp $(DEPS)
	$(CC) -c -o $@ $< $(CFLAGS)

server.o: server.cpp $(DEPS)
	$(CC) -c -o $@ $< $(CFLAGS)

$(ODIR)/%.o: %.cpp $(DEPS)
	$(CC) -c -o $@ $< $(CFLAGS)


server: $(SERVER_OBJ)
	$(CC) -o $@ $^ $(CFLAGS) $(LIBS)

client: $(client_objects)
	$(CC) -o $@ $^ $(CFLAGS) $(LIBS)


clean:
	rm -f *.o server client